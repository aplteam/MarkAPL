 R←Test_Mat2Markdown_002(stopFlag batchFlag);⎕TRAP;ns;m;md;ch
⍝ Test the conversion of an APL matrix to markdown with column header that carries colons.
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←∆Failed

 m←''
 m,←⊂'APL' 99 'Really great '
 m,←⊂'Python' 70 'Nice `|`'
 m,←⊂'Cobol' 1 'Oh|dear'
 ch←'Language' 'Productivity' 'Comment'

 md←ch ##.MarkAPL.Matrix2MarkdownTable⊃m
 ns←##.MarkAPL.Init''md
 ns←##.MarkAPL.Process ns

 →FailsIf'<table>'≢0⊃ns.html
 →FailsIf'<thead>'≢1⊃ns.html
 →FailsIf 3≠≢'<th[ >]'⎕S 0⊣ns.html
 →FailsIf'</thead>'≢7⊃ns.html
 →FailsIf'<tbody>'≢8⊃ns.html
 →FailsIf 6≠+/∨/¨'<td>'∘⍷¨ns.html
 →FailsIf 3≠+/∨/¨'<td '∘⍷¨ns.html
 →FailsIf 4≠+/∨/¨'<tr>'∘⍷¨ns.html
 →FailsIf 4≠+/∨/¨'</tr>'∘⍷¨ns.html
 →FailsIf'</table>'≢↑¯1↑ns.html
 →FailsIf'</tbody>'≢↑¯2↑ns.html

 →FailsIf 6≠+/∨/¨(⊂'<td>')⍷¨ns.html
 →FailsIf 3≠+/∨/¨(⊂'<td style="text-align: right;">')⍷¨ns.html

 R←∆OK
